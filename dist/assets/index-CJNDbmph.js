import{ac as N,ad as v,r as d,ae as T,j as a,y as _,af as k,ag as M,T as S,ah as I,ai as R,aj as E,ak as i,al as G,am as A,b as f,u as B,a6 as F,a as U,V as h,B as g,a8 as L,d as O,an as q,ao as P,ap as V}from"./index-B_QWfTc0.js";import{u as W}from"./useQuery-BJpiDE26.js";import{d as z,f as H,R as Q}from"./user.apis-CQ52kz8D.js";import{M as K}from"./ManagementPageLayout-BNCoekW3.js";import{G as x}from"./GridActionsCellItem-NKfo_Zc-.js";function X(t){return N("MuiDialogContentText",t)}v("MuiDialogContentText",["root"]);const $=t=>{const{classes:s}=t,n=M({root:["root"]},X,s);return{...s,...n}},J=_(S,{shouldForwardProp:t=>I(t)||t==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(t,s)=>s.root})({}),Y=d.forwardRef(function(s,o){const n=T({props:s,name:"MuiDialogContentText"}),{children:c,className:u,...l}=n,r=$(l);return a.jsx(J,{component:"p",variant:"body1",color:"textSecondary",ref:o,ownerState:l,className:k(r.root,u),...n,classes:r})}),Z=({isDialogOpen:t,handleCloseDialog:s,handleConfirmDelete:o,employeeData:n})=>n?a.jsxs(R,{open:t,onClose:s,children:[a.jsx(E,{children:i("admin.employee_managemet.delete.title")}),a.jsx(G,{children:a.jsxs(Y,{children:[i("admin.employee_managemet.delete.make_sure")," ",n.fullName,"? ",i("admin.employee_managemet.delete.cannot_change")]})}),a.jsxs(A,{children:[a.jsx(f,{onClick:s,children:i("admin.employee_managemet.cancel")}),a.jsx(f,{onClick:o,color:"error",variant:"contained",children:i("admin.employee_managemet.delete.confirm")})]})]}):null,ne=()=>{const t=B(),s=F(),{t:o}=U(),[n,c]=d.useState(null),[u,l]=d.useState(!1),{data:r,isLoading:y,error:m}=W({queryKey:["users","employees"],queryFn:async()=>{const e=await H(Q.Employee);if(!e.isSuccess||!e.data)throw new Error(e.message||"Failed to fetch employees");return e.data}});d.useEffect(()=>{m&&h.error(m instanceof Error?m.message:"Failed to load employees")},[m,s]);const w=e=>t(`/admin/ql-nhan-vien/${e}`),C=e=>{const p=r==null?void 0:r.find(j=>j.userName===e);p&&(c(p),l(!0))},D=async()=>{if(n)try{await z(n.userId)&&h.success(o("toast.employee.deleteSuccess"))}catch{h.error(o("toast.employee.deleteFailed"))}l(!1),c(null)},b=d.useMemo(()=>[{field:"userName",headerName:o("common.table_header.user.username"),width:250,renderCell:e=>a.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2},children:[a.jsx(L,{src:e.row.avatar||"/default-avatar.png",alt:e.row.fullName}),a.jsx("span",{children:e.row.userName})]})},{field:"fullName",headerName:o("common.table_header.user.fullname"),width:180},{field:"email",headerName:o("common.table_header.user.email"),width:220},{field:"phoneNumber",headerName:o("common.table_header.user.phone"),width:130},{field:"status",headerName:o("common.table_header.user.status"),width:120,renderCell:e=>a.jsx(O,{label:e.row.status===1?"Active":"Inactive",color:e.row.status===1?"success":"error",sx:{fontWeight:"bold",borderRadius:"16px",minWidth:"80px"}})},{field:"address",headerName:o("common.table_header.user.address"),width:130},{field:"actions",headerName:o("common.table_header.actions"),type:"actions",width:100,getActions:e=>[a.jsx(x,{icon:a.jsx(q,{}),label:"Edit",onClick:()=>w(e.row.userId)}),e.row.status===1&&a.jsx(x,{icon:a.jsx(P,{}),label:"Delete",onClick:()=>C(e.row.userName),showInMenu:!0})]}],[o]);return a.jsxs(K,{children:[a.jsx(f,{sx:{marginBottom:"20px",marginLeft:"auto",color:"black",borderColor:"black"},onClick:()=>{t("/admin/ql-nhan-vien/them-moi")},children:"Thêm nhân viên"}),a.jsx(g,{sx:{width:"100%",height:600,"& .MuiDataGrid-root":{border:"none",backgroundColor:"white",borderRadius:2,boxShadow:1,"& .MuiDataGrid-columnHeaders":{color:"black",fontWeight:"bold"},"& .MuiDataGrid-cell":{borderBottom:"1px solid #f0f0f0"},"& .MuiDataGrid-row:hover":{backgroundColor:"#f5f5f5"}}},children:a.jsx(V,{rows:r||[],columns:b,loading:y,getRowId:e=>e.userId,initialState:{pagination:{paginationModel:{pageSize:10}}},pageSizeOptions:[5,10,25],disableRowSelectionOnClick:!0,autoHeight:!0})}),a.jsx(Z,{isDialogOpen:u,handleCloseDialog:()=>{l(!1),c(null)},handleConfirmDelete:D,employeeData:n})]})};export{ne as default};
