import{u as q,aK as k,r as o,j as e,C as U,B as g,T as n,b as j,x as W,G as i,l as C,F as M,I as F,S as P,f as Y,ai as z,aj as B,al as Q,am as G,e as O}from"./index-BUPix-ev.js";import{T as L}from"./TheaterComedy-BanPBbN4.js";import{S as H}from"./Snackbar-CwpuGNrf.js";import{A as K}from"./Alert-R87I6AkX.js";const b=l=>{const u="àáâãäåạảấầẩẫậắằẳẵặẹẻẽềềểễệìíîïịỉĩòóôõöøọỏốồổỗộớờởỡợụủũưừửữựỳýỵỷỹđÀÁÂÃÄÅẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂỄỆÌÍÎÏỊỈĨÒÓÔÕÖØỌỎỐỒỔỖỘỚỜỞỠỢỤỦŨƯỪỬỮỰỲÝỴỶỸĐ",a="aaaaaaaaaaaaaaaaaaeeeeeeeeeeeiiiiiioooooooooooooooooouuuuuuuuyyyyydAAAAAAAAAAAAAAAAAAAAAEEEEEEEEEEEEIIIIIIOOOOOOOOOOOOOOOOOOUUUUUUUUYYYYYD";let d="";for(let t=0;t<l.length;t++){const m=u.indexOf(l[t]);m>=0?d+=a[m]:d+=l[t]}return d},Z=()=>{const l=q(),u=k(),[a,d]=o.useState(""),[t,m]=o.useState(5),[h,S]=o.useState(7),[R,E]=o.useState([]),[v,A]=o.useState(""),[w,f]=o.useState(!1),[x,c]=o.useState({open:!1,message:"",severity:"success"});o.useEffect(()=>{(async()=>{try{const r=await O.get("movietheater");r.data.isSuccess&&(E(r.data.data),r.data.data.length>0&&A(r.data.data[0].movieTheaterId))}catch(r){console.error("Error fetching movie theaters:",r),c({open:!0,message:"Failed to load movie theaters",severity:"error"})}})()},[]);const y=()=>t*h,D=async()=>{if(!a||!v){c({open:!0,message:"Please fill in all required fields",severity:"error"});return}const r={roomName:b(a),row:t,column:h,total:y()};try{const p=await O.post(`room?MovieTheaterId=${v}`,r,{headers:{"Content-Type":"application/json"}});p.data.isSuccess?(c({open:!0,message:"Room created successfully",severity:"success"}),f(!1),u.invalidateQueries("PhongChieuData"),u.invalidateQueries("rooms"),setTimeout(()=>{l("/admin/ql-phong-chieu",{state:{refresh:!0}})},1500)):c({open:!0,message:"Failed to create room: "+p.data.message,severity:"error"})}catch(p){console.error("Error creating room:",p),c({open:!0,message:"Failed to create room. Please try again.",severity:"error"})}},I=()=>{c({...x,open:!1})},N=()=>{f(!0)},T=()=>{f(!1)};return e.jsxs(U,{maxWidth:"xl",sx:{py:3},children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",mb:4,justifyContent:"space-between"},children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(L,{sx:{fontSize:32,color:"primary.main",mr:2}}),e.jsx(n,{variant:"h4",fontWeight:"bold",children:"Create New Room"})]}),e.jsx(j,{variant:"outlined",onClick:()=>l("/admin/ql-phong-chieu"),sx:{borderRadius:2},children:"Return to Room List"})]}),e.jsx(W,{elevation:3,sx:{p:4,borderRadius:2},children:e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,label:"Room Name",value:a,onChange:s=>d(s.target.value),required:!0,helperText:"Note: Vietnamese characters will be converted to ASCII equivalents (e.g., 'ố' → 'o')"})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsxs(M,{fullWidth:!0,required:!0,children:[e.jsx(F,{id:"movie-theater-label",children:"Movie Theater"}),e.jsx(P,{labelId:"movie-theater-label",value:v,label:"Movie Theater",onChange:s=>A(s.target.value),children:R.map(s=>e.jsx(Y,{value:s.movieTheaterId,children:s.name},s.movieTheaterId))})]})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,label:"Rows",type:"number",value:t,onChange:s=>m(parseInt(s.target.value)),inputProps:{min:1},required:!0})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,label:"Columns",type:"number",value:h,onChange:s=>S(parseInt(s.target.value)),inputProps:{min:1},required:!0})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(g,{sx:{mt:2,p:2,bgcolor:"#f5f5f5",borderRadius:1,textAlign:"center"},children:e.jsxs(n,{variant:"h6",children:["Total seats: ",y()]})})}),e.jsx(i,{item:!0,xs:12,sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsx(j,{variant:"contained",color:"primary",size:"large",onClick:N,sx:{minWidth:200},children:"Create Room"})})]})}),e.jsxs(z,{open:w,onClose:T,children:[e.jsx(B,{children:"Confirm Room Creation"}),e.jsxs(Q,{children:[e.jsx(n,{children:"Are you sure you want to create a room with the following details?"}),e.jsxs(g,{sx:{mt:2},children:[e.jsxs(n,{children:[e.jsx("strong",{children:"Room Name:"})," ",a]}),a!==b(a)&&e.jsxs(n,{color:"warning.main",variant:"body2",sx:{mb:1},children:["Will be stored as: ",b(a)]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Rows:"})," ",t]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Columns:"})," ",h]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Total Seats:"})," ",y()]})]})]}),e.jsxs(G,{children:[e.jsx(j,{onClick:T,color:"inherit",children:"Cancel"}),e.jsx(j,{onClick:D,color:"primary",variant:"contained",children:"Confirm"})]})]}),e.jsx(H,{open:x.open,autoHideDuration:5e3,onClose:I,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(K,{onClose:I,severity:x.severity,children:x.message})})]})};export{Z as default};
