import{u as M,aK as W,r,j as e,C as F,B as u,T as a,b as m,x as N,G as o,l as g,F as P,I as A,S as E,f as O,aj as z,ak as B,am as Q,an as G,e as b}from"./index-B2eA6uDr.js";import{T as L}from"./TheaterComedy-D9Hk7WFK.js";import{S as H}from"./Snackbar-Bq2z-enb.js";import{A as K}from"./Alert-B43tdk10.js";const X=()=>{const j=M(),v=W(),[i,T]=r.useState(""),[l,S]=r.useState(5),[c,R]=r.useState(7),[I,w]=r.useState([]),[h,f]=r.useState(""),[D,x]=r.useState(!1),[d,n]=r.useState({open:!1,message:"",severity:"success"});r.useEffect(()=>{(async()=>{try{const s=await b.get("movietheater");s.data.isSuccess&&(w(s.data.data),s.data.data.length>0&&f(s.data.data[0].movieTheaterId))}catch(s){console.error("Error fetching movie theaters:",s),n({open:!0,message:"Failed to load movie theaters",severity:"error"})}})()},[]);const p=()=>l*c,k=async()=>{if(!i||!h){n({open:!0,message:"Please fill in all required fields",severity:"error"});return}const t={roomName:i,row:l,column:c,total:p()};try{const s=await b.post(`room?MovieTheaterId=${h}`,t,{headers:{"Content-Type":"application/json"}});s.data.isSuccess?(n({open:!0,message:"Room created successfully",severity:"success"}),x(!1),v.invalidateQueries("PhongChieuData"),v.invalidateQueries("rooms"),setTimeout(()=>{j("/admin/ql-phong-chieu",{state:{refresh:!0}})},1500)):n({open:!0,message:"Failed to create room: "+s.data.message,severity:"error"})}catch(s){console.error("Error creating room:",s),n({open:!0,message:"Failed to create room. Please try again.",severity:"error"})}},C=()=>{n({...d,open:!1})},q=()=>{x(!0)},y=()=>{x(!1)};return e.jsxs(F,{maxWidth:"xl",sx:{py:3},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",mb:4,justifyContent:"space-between"},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(L,{sx:{fontSize:32,color:"primary.main",mr:2}}),e.jsx(a,{variant:"h4",fontWeight:"bold",children:"Create New Room"})]}),e.jsx(m,{variant:"outlined",onClick:()=>j("/admin/ql-phong-chieu"),sx:{borderRadius:2},children:"Return to Room List"})]}),e.jsx(N,{elevation:3,sx:{p:4,borderRadius:2},children:e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(g,{fullWidth:!0,label:"Room Name",value:i,onChange:t=>T(t.target.value),required:!0})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(P,{fullWidth:!0,required:!0,children:[e.jsx(A,{id:"movie-theater-label",children:"Movie Theater"}),e.jsx(E,{labelId:"movie-theater-label",value:h,label:"Movie Theater",onChange:t=>f(t.target.value),children:I.map(t=>e.jsx(O,{value:t.movieTheaterId,children:t.name},t.movieTheaterId))})]})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(g,{fullWidth:!0,label:"Rows",type:"number",value:l,onChange:t=>S(parseInt(t.target.value)),inputProps:{min:1},required:!0})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(g,{fullWidth:!0,label:"Columns",type:"number",value:c,onChange:t=>R(parseInt(t.target.value)),inputProps:{min:1},required:!0})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(u,{sx:{mt:2,p:2,bgcolor:"#f5f5f5",borderRadius:1,textAlign:"center"},children:e.jsxs(a,{variant:"h6",children:["Total seats: ",p()]})})}),e.jsx(o,{item:!0,xs:12,sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsx(m,{variant:"contained",color:"primary",size:"large",onClick:q,sx:{minWidth:200},children:"Create Room"})})]})}),e.jsxs(z,{open:D,onClose:y,children:[e.jsx(B,{children:"Confirm Room Creation"}),e.jsxs(Q,{children:[e.jsx(a,{children:"Are you sure you want to create a room with the following details?"}),e.jsxs(u,{sx:{mt:2},children:[e.jsxs(a,{children:[e.jsx("strong",{children:"Room Name:"})," ",i]}),e.jsxs(a,{children:[e.jsx("strong",{children:"Rows:"})," ",l]}),e.jsxs(a,{children:[e.jsx("strong",{children:"Columns:"})," ",c]}),e.jsxs(a,{children:[e.jsx("strong",{children:"Total Seats:"})," ",p()]})]})]}),e.jsxs(G,{children:[e.jsx(m,{onClick:y,color:"inherit",children:"Cancel"}),e.jsx(m,{onClick:k,color:"primary",variant:"contained",children:"Confirm"})]})]}),e.jsx(H,{open:d.open,autoHideDuration:5e3,onClose:C,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(K,{onClose:C,severity:d.severity,children:d.message})})]})};export{X as default};
