import{G as D,J as C,r as d,K as j,j as o,p as T,N as E,O as v,T as w,Q as R,R as M,U as N,W as S,X as U,b as p,u as F,V as u}from"./index-C67ppINo.js";import{d as I,f as L,R as O}from"./user.apis-CZ1YVnpm.js";import{M as P,d as V}from"./ManagementTable-BJzTQn7y.js";import{M as X}from"./ManagementPageLayout-6ZuAVrRI.js";import{u as b}from"./useQuery-RALlih2e.js";import"./TableContainer-HWKORDCn.js";import"./TableRow-DBHM6I3C.js";function k(s){return D("MuiDialogContentText",s)}C("MuiDialogContentText",["root"]);const q=s=>{const{classes:e}=s,n=v({root:["root"]},k,e);return{...e,...n}},B=T(w,{shouldForwardProp:s=>R(s)||s==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(s,e)=>e.root})({}),Q=d.forwardRef(function(e,a){const n=j({props:e,name:"MuiDialogContentText"}),{children:i,className:l,...c}=n,r=q(c);return o.jsx(B,{component:"p",variant:"body1",color:"textSecondary",ref:a,ownerState:c,className:E(r.root,l),...n,classes:r})}),A=({isDialogOpen:s,handleCloseDialog:e,handleConfirmDelete:a,employeeData:n})=>n?o.jsxs(M,{open:s,onClose:e,children:[o.jsx(N,{children:"Xác nhận xóa nhân viên"}),o.jsx(S,{children:o.jsxs(Q,{children:["Bạn có chắc chắn muốn xóa nhân viên ",n.fullName,"? Hành động này không thể hoàn tác."]})}),o.jsxs(U,{children:[o.jsx(p,{onClick:e,children:"Hủy"}),o.jsx(p,{onClick:a,color:"error",variant:"contained",children:"Xóa"})]})]}):null,Y=()=>{const s=F(),[e,a]=d.useState(null),[n,i]=d.useState(!1),{data:l,isLoading:c,error:r}=b({queryKey:["users","employees"],queryFn:async()=>{const t=await L(O.Employee);if(!t.isSuccess||!t.data)throw new Error(t.message||"Failed to fetch employees");return t.data}});d.useEffect(()=>{r&&u.error(r instanceof Error?r.message:"Failed to load employees")},[r]);const f=t=>{s(`/admin/ql-nhan-vien/${t}`)},h=t=>{const m=l==null?void 0:l.find(x=>x.userId===t);m&&(a(m),i(!0))},g=async()=>{if(e)try{await I(e.userId)&&u.success("Employee deleted successfully")}catch{u.error("Failed to delete employee")}i(!1),a(null)},y=[...V,{field:"joinDate",headerName:"Join Date",align:"center",renderCell:t=>new Date(t.joinDate).toLocaleDateString()}];return o.jsxs(X,{children:[o.jsx(P,{data:l,columns:y,onEdit:f,onDelete:h,isLoading:c}),o.jsx(A,{isDialogOpen:n,handleCloseDialog:()=>{i(!1),a(null)},handleConfirmDelete:g,employeeData:e})]})};export{Y as default};
