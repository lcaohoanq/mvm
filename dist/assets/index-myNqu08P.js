import{ac as H,ad as $,r as i,ae as X,j as t,y as K,af as Y,ag as J,T as R,ah as Z,c as z,ai as ee,aj as te,ak as h,al as oe,am as se,b as T,u as ae,a6 as ne,a as re,an as le,a4 as ie,ao as N,V as M,B as y,a8 as ce,d as de,ap as me,aq as ue,x as he,R as pe,ar as xe}from"./index-B5yB94Ou.js";import{k as fe,G as I,C as ge,a as ye,P as we}from"./swapy-D8f65QYG.js";import{u as be}from"./useQuery-uzCuBpaK.js";import{d as je,f as ve,R as Ce}from"./user.apis-CiH4mGMn.js";import{M as Se}from"./ManagementPageLayout-BRjYdH6d.js";function De(a){return H("MuiDialogContentText",a)}$("MuiDialogContentText",["root"]);const Ee=a=>{const{classes:n}=a,r=J({root:["root"]},De,n);return{...n,...r}},Ne=K(R,{shouldForwardProp:a=>Z(a)||a==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(a,n)=>n.root})({}),Me=i.forwardRef(function(n,o){const r=X({props:n,name:"MuiDialogContentText"}),{children:p,className:w,...d}=r,x=Ee(d);return t.jsx(Ne,{component:"p",variant:"body1",color:"textSecondary",ref:o,ownerState:d,className:Y(x.root,w),...r,classes:x})}),Re=z([t.jsx("path",{d:"M14 7h-4c-1.1 0-2 .9-2 2v6h2v7h4v-7h2V9c0-1.1-.9-2-2-2"},"0"),t.jsx("circle",{cx:"12",cy:"4",r:"2"},"1")],"Man"),_e=z([t.jsx("path",{d:"M13.94 8.31C13.62 7.52 12.85 7 12 7s-1.62.52-1.94 1.31L7 16h3v6h4v-6h3z"},"0"),t.jsx("circle",{cx:"12",cy:"4",r:"2"},"1")],"Woman"),ke=({isDialogOpen:a,handleCloseDialog:n,handleConfirmDelete:o,employeeData:r})=>r?t.jsxs(ee,{open:a,onClose:n,children:[t.jsx(te,{children:h("admin.employee_managemet.delete.title")}),t.jsx(oe,{children:t.jsxs(Me,{children:[h("admin.employee_managemet.delete.make_sure")," ",r.fullName,"? ",h("admin.employee_managemet.delete.cannot_change")]})}),t.jsxs(se,{children:[t.jsx(T,{onClick:n,children:h("admin.employee_managemet.cancel")}),t.jsx(T,{onClick:o,color:"error",variant:"contained",children:h("admin.employee_managemet.delete.confirm")})]})]}):null,Fe=()=>{const a=ae(),n=ne(),{t:o}=re(),[r,p]=i.useState(null),[w,d]=i.useState(!1),x=le(),f=i.useRef(null),b=i.useRef(null),j=ie(),c=N(j.breakpoints.down("sm")),A=N(j.breakpoints.down("md"));N(j.breakpoints.down("lg"));const[W,F]=i.useState(["employees","active","inactive","male","female"]),{data:s,isLoading:O,error:g}=be({queryKey:["users","employees"],queryFn:async()=>{const e=await ve(Ce.Employee);if(!e.isSuccess||!e.data)throw new Error(e.message||"Failed to fetch employees");return e.data}}),_=(s==null?void 0:s.length)||0,k=(s==null?void 0:s.filter(e=>e.status===1).length)||0,B=_-k,G=(s==null?void 0:s.filter(e=>e.gender===1).length)||0,P=(s==null?void 0:s.filter(e=>e.gender===2).length)||0,m={employees:{id:"employees",title:o("common.stats.total_employees")||"Total Employees",value:_,icon:t.jsx(we,{sx:{fontSize:40}}),color:"#4051B5"},active:{id:"active",title:o("common.stats.active_employees")||"Active Employees",value:k,icon:t.jsx(ye,{sx:{fontSize:40}}),color:"#4CAF50"},inactive:{id:"inactive",title:o("common.stats.inactive_employees")||"Inactive Employees",value:B,icon:t.jsx(ge,{sx:{fontSize:40}}),color:"#E50046"},male:{id:"male",title:o("common.stats.male_employees")||"Male Employees",value:G,icon:t.jsx(Re,{sx:{fontSize:40}}),color:"#2196F3"},female:{id:"female",title:o("common.stats.female_employees")||"Female Employees",value:P,icon:t.jsx(_e,{sx:{fontSize:40}}),color:"#E91E63"}};i.useEffect(()=>{let e;return b.current&&(e=setTimeout(()=>{try{f.current=fe(b.current,{animation:"spring",swapMode:"drop",autoScrollOnDrag:!0,enabled:!0,dragAxis:"both",dragOnHold:!1}),f.current.onSwap(l=>{console.log("Swap occurred:",l);const{fromSlot:v,toSlot:V}=l;F(C=>{const u=[...C],S=C.findIndex(E=>E===v),D=C.findIndex(E=>E===V);return S!==-1&&D!==-1&&([u[S],u[D]]=[u[D],u[S]]),u})})}catch(l){console.error("Swapy initialization error:",l)}},100)),()=>{if(clearTimeout(e),f.current)try{f.current.destroy()}catch(l){console.error("Error destroying Swapy:",l)}}},[]),i.useEffect(()=>{g&&M.error(g instanceof Error?g.message:"Failed to load employees")},[g,n]);const L=e=>a(`/admin/ql-nhan-vien/${e}`),U=e=>{const l=s==null?void 0:s.find(v=>v.userName===e);l&&(p(l),d(!0))},q=async()=>{if(r)try{await je(r.userId)&&(M.success(o("toast.employee.deleteSuccess")),x.invalidateQueries(["users","employees"]))}catch{M.error(o("toast.employee.deleteFailed"))}d(!1),p(null)},Q=i.useMemo(()=>[{field:"userName",headerName:o("common.table_header.user.username"),width:250,renderCell:e=>t.jsxs(y,{sx:{display:"flex",alignItems:"center",gap:2},children:[t.jsx(ce,{src:e.row.avatar||"/default-avatar.png",alt:e.row.fullName}),t.jsx("span",{children:e.row.userName})]})},{field:"fullName",headerName:o("common.table_header.user.fullname"),width:180},{field:"email",headerName:o("common.table_header.user.email"),width:220},{field:"phoneNumber",headerName:o("common.table_header.user.phone"),width:130},{field:"status",headerName:o("common.table_header.user.status"),width:120,renderCell:e=>t.jsx(de,{label:e.row.status===1?"Active":"Inactive",color:e.row.status===1?"success":"error",sx:{fontWeight:"bold",borderRadius:"16px",minWidth:"80px"}})},{field:"address",headerName:o("common.table_header.user.address"),width:130},{field:"actions",headerName:o("common.table_header.actions"),type:"actions",width:100,getActions:e=>[t.jsx(I,{icon:t.jsx(me,{}),label:"Edit",onClick:()=>L(e.row.userId),disabled:e.row.status!==1,sx:{color:e.row.status!==1?"gray":"inherit",opacity:e.row.status!==1?.5:1}}),t.jsx(I,{icon:t.jsx(ue,{}),label:"Delete",onClick:()=>U(e.row.userName),showInMenu:!0,disabled:e.row.status!==1,sx:{color:e.row.status!==1?"gray":"inherit",opacity:e.row.status!==1?.5:1}})]}],[o]);return t.jsxs(Se,{children:[t.jsx("div",{ref:b,className:"swapy-container",style:{marginBottom:"1.5rem",display:"flex",flexWrap:"wrap",gap:"8px",justifyContent:"center"},children:W.map(e=>t.jsx("div",{className:"swapy-slot","data-swapy-slot":e,style:{margin:"4px",flex:c?"1 1 100%":A?"1 1 45%":"1 1 230px",minWidth:c?"100%":"230px",maxWidth:c?"100%":"350px",display:"inline-block"},children:t.jsx("div",{className:"swapy-item","data-swapy-item":e,style:{cursor:"grab"},children:t.jsxs(he,{elevation:3,sx:{p:c?2:3,borderRadius:2,height:"100%",borderLeft:`5px solid ${m[e].color}`,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-5px)",boxShadow:"0 10px 20px rgba(0,0,0,0.15)"}},children:[t.jsxs(y,{children:[t.jsx(R,{variant:c?"subtitle1":"h6",fontWeight:"bold",children:m[e].title}),t.jsx(R,{variant:c?"h5":"h4",fontWeight:"bold",mt:1,children:m[e].value})]}),t.jsx(y,{sx:{backgroundColor:`${m[e].color}20`,p:c?1.5:2,ml:2,borderRadius:"50%",color:m[e].color,display:"flex",alignItems:"center",justifyContent:"center"},children:pe.cloneElement(m[e].icon,{sx:{fontSize:c?30:40}})})]})})},e))}),t.jsx(y,{sx:{width:"100%",height:600,"& .MuiDataGrid-root":{border:"none",backgroundColor:"white",borderRadius:2,boxShadow:1,"& .MuiDataGrid-columnHeaders":{color:"black",fontWeight:"bold"},"& .MuiDataGrid-cell":{borderBottom:"1px solid #f0f0f0"},"& .MuiDataGrid-row:hover":{backgroundColor:"#f5f5f5"}}},children:t.jsx(xe,{rows:s||[],columns:Q,loading:O,getRowId:e=>e.userId,initialState:{pagination:{paginationModel:{pageSize:10}}},pageSizeOptions:[5,10,25],disableRowSelectionOnClick:!0,autoHeight:!0})}),t.jsx(ke,{isDialogOpen:w,handleCloseDialog:()=>{d(!1),p(null)},handleConfirmDelete:q,employeeData:r})]})};export{Fe as default};
