import{a0 as U,u as V,r as s,j as a,L,C as W,B as r,T as f,l as n,h as D,b as m,o as x,V as p}from"./index-D08WwhE9.js";import{u as S}from"./useQuery-BzXUVCug.js";import{u as w,a as E}from"./user.apis-BtvizS59.js";import{M as P}from"./ManagementPageLayout-B4VkQ5br.js";import{F as M}from"./FileUploadOutlined-u9VqCWQd.js";import{R as T,a as g}from"./RadioGroup-CYLatu-A.js";const Q=()=>{const{id:i}=U(),j=V(),{data:e=null,isLoading:b,error:v}=S({queryKey:["memberDetail",i],queryFn:async()=>{const t=await E(i);if(!t.isSuccess||!t.data)throw new Error(t.message||"Failed to fetch member data");return t.data}}),[l,o]=s.useState(null),[y,c]=s.useState(null),u=s.useRef(null);if(s.useEffect(()=>{e&&e.avatar&&o(e.avatar)},[e]),s.useEffect(()=>{l&&console.log("Image URL updated:",l)},[l]),!e)return null;if(b)return a.jsx(L,{});if(v)return a.jsx("div",{children:"Failed to fetch data"});if(!e)return a.jsx("div",{children:"No employee data found"});const C=t=>{var h;const d=(h=t.target.files)==null?void 0:h[0];if(d){console.log(d);const R=URL.createObjectURL(d);o(R),c(d)}t.target.value=""},N=t=>{o(t.target.value)},F=()=>{o(null),c(null),u.current&&(u.current.value="")},I=async()=>{if(i)try{await w(i,{fullName:e.fullName,birthDate:e.birthDate,avatar:e.avatar,gender:e.gender,email:e.email,phoneNumber:e.phoneNumber,address:e.address}),console.log("Image to save:",y||l),p.success("Cập nhật thông tin thành công")}catch{p.error("Cập nhật thông tin thất bại")}};return a.jsx(P,{children:a.jsx(W,{maxWidth:"md",children:a.jsxs(r,{sx:{py:4},children:[a.jsx(f,{variant:"h4",component:"h1",sx:{mb:4},children:"Chỉnh sửa thông tin nhân viên"}),a.jsxs(r,{sx:{mb:2},children:[a.jsx(n,{fullWidth:!0,margin:"normal",label:"Hình ảnh",variant:"standard",value:l||"",onChange:N,InputProps:{endAdornment:a.jsxs(D,{component:"label",children:[a.jsx(M,{}),a.jsx("input",{ref:u,style:{display:"none"},type:"file",accept:"image/*",hidden:!0,onChange:C,name:"[licenseFile]"})]})}}),l&&a.jsxs(r,{sx:{mt:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[a.jsx(r,{component:"img",src:l,alt:"Preview",sx:{maxWidth:"100%",maxHeight:"200px",objectFit:"contain",border:"1px solid #ddd",borderRadius:"4px",mt:1}}),a.jsx(m,{size:"small",color:"error",onClick:F,sx:{mt:1},children:"Xóa hình"})]})]}),a.jsx(n,{label:"Tài khoản",variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.userName}),a.jsx(n,{label:"Họ tên",variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.fullName}),a.jsx(n,{label:"Ngày sinh",variant:"standard",fullWidth:!0,margin:"normal",type:"date",defaultValue:e.birthDate,InputLabelProps:{style:{top:"-1.5rem"}}}),a.jsxs(r,{sx:{display:"flex",gap:"2rem",alignItems:"center",justifyContent:"flex-start",my:2},children:[a.jsx(f,{children:"Giới tính"}),a.jsxs(T,{defaultValue:e.gender||"Male",sx:{display:"flex",gap:10,flexDirection:"row"},children:[a.jsx(x,{value:"Male",control:a.jsx(g,{}),label:"Nam"}),a.jsx(x,{value:"Female",control:a.jsx(g,{}),label:"Nữ"})]})]}),a.jsx(n,{label:"Email",variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.email}),a.jsx(n,{label:"Số CMND",variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.idCard}),a.jsx(n,{label:"Số điện thoại",variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.phoneNumber}),a.jsx(n,{label:"Địa chỉ",variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.address}),a.jsxs(r,{sx:{mt:4,display:"flex",justifyContent:"flex-end",gap:2},children:[a.jsx(m,{onClick:()=>{j(-1)},color:"error",variant:"contained",children:"Quay lại"}),a.jsx(m,{onClick:I,color:"primary",variant:"contained",children:"Lưu thay đổi"})]})]})})})};export{Q as default};
