import{W,u as V,r as i,j as a,L,C as w,B as s,T as x,ak as t,l as r,h as E,b as c,o as b,V as j}from"./index-DYNoSv3m.js";import{u as P}from"./useQuery-CyvMAyhz.js";import{u as S,a as k}from"./user.apis-CuLSb9uD.js";import{M as B}from"./ManagementPageLayout-DhXXdsMy.js";import{F as T}from"./FileUploadOutlined-qdowy6P6.js";import{R as q,a as v}from"./RadioGroup-DGHZFi8W.js";const K=()=>{const{id:d}=W(),y=V(),{data:e=null,isLoading:C,error:N}=P({queryKey:["memberDetail",d],queryFn:async()=>{const n=await k(d);if(!n.isSuccess||!n.data)throw new Error(n.message||"Failed to fetch member data");return n.data}}),[l,m]=i.useState(null),[_,h]=i.useState(null),u=i.useRef(null);if(i.useEffect(()=>{e&&e.avatar&&m(e.avatar)},[e]),i.useEffect(()=>{l&&console.log("Image URL updated:",l)},[l]),!e)return null;const[f,g]=i.useState({fullName:"",birthDate:"",avatar:"",gender:0,email:"",phoneNumber:"",address:"",idCard:""});if(i.useEffect(()=>{e&&(g({fullName:e.fullName,birthDate:e.birthDate||"",avatar:e.avatar,gender:e.gender,email:e.email,phoneNumber:e.phoneNumber,address:e.address,idCard:e.idCard}),e.avatar&&m(e.avatar))},[e]),C)return a.jsx(L,{});if(N)return a.jsx("div",{children:"Failed to fetch data"});if(!e)return a.jsx("div",{children:"No employee data found"});const D=n=>{var p;const o=(p=n.target.files)==null?void 0:p[0];if(o){console.log(o);const U=URL.createObjectURL(o);m(U),h(o)}n.target.value=""},F=n=>{m(n.target.value)},I=()=>{m(null),h(null),u.current&&(u.current.value="")},R=async()=>{if(d)try{await S(d,{fullName:e.fullName,birthDate:e.birthDate,avatar:e.avatar,gender:e.gender,email:e.email,phoneNumber:e.phoneNumber,address:e.address}),console.log("Image to save:",_||l),j.success("Cập nhật thông tin thành công")}catch{j.error("Cập nhật thông tin thất bại")}};return a.jsx(B,{children:a.jsx(w,{maxWidth:"md",children:a.jsxs(s,{sx:{py:4},children:[a.jsx(x,{variant:"h4",component:"h1",sx:{mb:4},children:t("admin.member_management.title")}),a.jsxs(s,{sx:{mb:2},children:[a.jsx(r,{fullWidth:!0,margin:"normal",label:t("admin.member_management.image"),variant:"standard",value:l||"",onChange:F,InputProps:{endAdornment:a.jsxs(E,{component:"label",children:[a.jsx(T,{}),a.jsx("input",{ref:u,style:{display:"none"},type:"file",accept:"image/*",hidden:!0,onChange:D,name:"[licenseFile]"})]})}}),l&&a.jsxs(s,{sx:{mt:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[a.jsx(s,{component:"img",src:l,alt:"Preview",sx:{maxWidth:"100%",maxHeight:"200px",objectFit:"contain",border:"1px solid #ddd",borderRadius:"4px",mt:1}}),a.jsx(c,{size:"small",color:"error",onClick:I,sx:{mt:1},children:t("admin.member_management.remove_image")})]})]}),a.jsx(r,{label:t("admin.employee_management.detail.account"),variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.userName}),a.jsx(r,{label:t("admin.employee_management.detail.fullname"),variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.fullName}),a.jsx(r,{label:t("admin.employee_management.detail.birthday"),variant:"standard",fullWidth:!0,margin:"normal",type:"date",defaultValue:e.birthDate,InputLabelProps:{style:{top:"-1.5rem"}}}),a.jsxs(s,{sx:{display:"flex",gap:"2rem",alignItems:"center",justifyContent:"flex-start",my:2},children:[a.jsx(x,{children:t("admin.employee_management.detail.gender")}),a.jsxs(q,{value:f.gender,onChange:n=>g({...f,gender:Number(n.target.value)}),sx:{display:"flex",gap:10,flexDirection:"row"},children:[a.jsx(b,{value:0,control:a.jsx(v,{}),label:"Nam"}),a.jsx(b,{value:1,control:a.jsx(v,{}),label:"Nữ"})]})]}),a.jsx(r,{label:t("admin.employee_management.detail.email"),variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.email}),a.jsx(r,{label:t("admin.employee_management.detail.id_card"),variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.idCard}),a.jsx(r,{label:t("admin.employee_management.detail.phone"),variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.phoneNumber}),a.jsx(r,{label:t("admin.employee_management.detail.address"),variant:"standard",fullWidth:!0,margin:"normal",defaultValue:e.address}),a.jsxs(s,{sx:{mt:4,display:"flex",justifyContent:"flex-end",gap:2},children:[a.jsx(c,{onClick:()=>{y(-1)},color:"error",variant:"contained",children:t("admin.employee_management.come_back")}),a.jsx(c,{onClick:R,color:"primary",variant:"contained",children:t("admin.employee_management.save")})]})]})})})};export{K as default};
