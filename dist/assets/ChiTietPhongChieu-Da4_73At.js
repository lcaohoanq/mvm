import{ae as Xt,ad as qt,r as h,af as Gt,aM as _,T as c,j as e,y as pe,ah as Yt,aN as ut,c as Ke,u as Jt,a0 as Zt,aJ as er,a4 as tr,a2 as J,L as rr,B as o,b as y,x as Re,an as xt,G as j,_ as sr,a9 as De,aa as $e,Z as v,a5 as ar,F as Ae,I as Pe,S as We,f as de,d as Le,ac as Z,O as ue,aj as Me,ak as ze,ao as pt,al as He,am as Ve,l as Ee,V as d,e as D}from"./index-hKNTF3Dt.js";import{E as k}from"./EventSeat-D8WPZciz.js";import{T as nr}from"./TheaterComedy-BhfSzywO.js";import{A as gt}from"./ArrowBack-6WnSzyko.js";import{C as mt}from"./CheckCircleOutline-Vcbsfvx0.js";import{I as or}from"./Info-CDfn_rK5.js";import{u as Ne}from"./useQuery-BjwSv2bA.js";import{M as Qe}from"./ManagementPageLayout-BOg1Mpm1.js";import{T as ir,a as ft}from"./Tabs-B_H17Iz4.js";import{A as X}from"./Alert-DnkuWLp8.js";function lr(S){return qt("MuiCardHeader",S)}const xe=Xt("MuiCardHeader",["root","avatar","action","content","title","subheader"]),cr=S=>{const{classes:n}=S;return Yt({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},lr,n)},hr=pe("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(S,n)=>[{[`& .${xe.title}`]:n.title},{[`& .${xe.subheader}`]:n.subheader},n.root]})({display:"flex",alignItems:"center",padding:16}),dr=pe("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(S,n)=>n.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),ur=pe("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(S,n)=>n.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),xr=pe("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(S,n)=>n.content})({flex:"1 1 auto",[`.${ut.root}:where(& .${xe.title})`]:{display:"block"},[`.${ut.root}:where(& .${xe.subheader})`]:{display:"block"}}),Ue=h.forwardRef(function(n,g){const R=Gt({props:n,name:"MuiCardHeader"}),{action:f,avatar:Q,component:p="div",disableTypography:U=!1,subheader:C,subheaderTypographyProps:ee,title:W,titleTypographyProps:w,slots:Oe={},slotProps:T={},...Be}=R,x={...R,component:p,disableTypography:U},I=cr(x),$={slots:Oe,slotProps:{title:w,subheader:ee,...T}};let V=W;const[ge,me]=_("title",{className:I.title,elementType:c,externalForwardedProps:$,ownerState:x,additionalProps:{variant:Q?"body2":"h5",component:"span"}});V!=null&&V.type!==c&&!U&&(V=e.jsx(ge,{...me,children:V}));let L=C;const[A,te]=_("subheader",{className:I.subheader,elementType:c,externalForwardedProps:$,ownerState:x,additionalProps:{variant:Q?"body2":"body1",color:"textSecondary",component:"span"}});L!=null&&L.type!==c&&!U&&(L=e.jsx(A,{...te,children:L}));const[K,re]=_("root",{ref:g,className:I.root,elementType:hr,externalForwardedProps:{...$,...Be,component:p},ownerState:x}),[se,O]=_("avatar",{className:I.avatar,elementType:dr,externalForwardedProps:$,ownerState:x}),[fe,G]=_("content",{className:I.content,elementType:xr,externalForwardedProps:$,ownerState:x}),[be,ae]=_("action",{className:I.action,elementType:ur,externalForwardedProps:$,ownerState:x});return e.jsxs(K,{...re,children:[Q&&e.jsx(se,{...O,children:Q}),e.jsxs(fe,{...G,children:[V,L]}),f&&e.jsx(be,{...ae,children:f})]})}),q=Ke([e.jsx("path",{d:"M7 11v2h10v-2c0-1.86 1.28-3.41 3-3.86V6c0-1.65-1.35-3-3-3H7C5.35 3 4 4.35 4 6v1.14c1.72.45 3 2 3 3.86"},"0"),e.jsx("path",{d:"M21 9c-1.1 0-2 .9-2 2v4H5v-4c0-1.1-.9-2-2-2s-2 .9-2 2v5c0 1.65 1.35 3 3 3v1c0 .55.45 1 1 1s1-.45 1-1v-1h12v1c0 .55.45 1 1 1s1-.45 1-1v-1c1.65 0 3-1.35 3-3v-5c0-1.1-.9-2-2-2"},"1")],"Chair"),bt=Ke(e.jsx("path",{fillRule:"evenodd",d:"M3 3v8h8V3zm6 6H5V5h4zm-6 4v8h8v-8zm6 6H5v-4h4zm4-16v8h8V3zm6 6h-4V5h4zm-6 4v8h8v-8zm6 6h-4v-4h4z"}),"GridView"),pr=Ke([e.jsx("path",{d:"M20 3H4c-1.11 0-2 .89-2 2v12c0 1.1.89 2 2 2h4v2h8v-2h4c1.1 0 2-.9 2-2V5c0-1.11-.9-2-2-2m0 14H4V5h16z"},"0"),e.jsx("path",{d:"M6.5 7.5H9V6H5v4h1.5zM19 12h-1.5v2.5H15V16h4z"},"1")],"ScreenshotMonitor"),gr=()=>{var nt,ot,it,lt,ct;const S=Jt(),{roomId:n}=Zt(),g=er(),R=tr(),[f,Q]=h.useState("row"),[p,U]=h.useState(""),[C,ee]=h.useState(null),[W,w]=h.useState(!1),[Oe,T]=h.useState(!1),[Be,x]=h.useState(null),[I,$]=h.useState([]),[V,ge]=h.useState(!0),[me,L]=h.useState(!1),[A,te]=h.useState(null),[K,re]=h.useState(!1),[se,O]=h.useState(null),[fe,G]=h.useState(!1),[be,ae]=h.useState(!1),[P,Fe]=h.useState([]),[ne,_e]=h.useState(!1),[Xe,ye]=h.useState(null),[yt,je]=h.useState(!1),[jt,qe]=h.useState(!1),[Y,Ge]=h.useState(""),[oe,Ye]=h.useState(0),[ie,Je]=h.useState(0),[le,Ze]=h.useState(!1),[et,ce]=h.useState(null),[vt,ve]=h.useState(!1),[St,Ct]=h.useState([]),[he,tt]=h.useState(""),[mr,fr]=h.useState(!1),rt=t=>{te(t),L(!0)},Se=()=>{L(!1),te(null),O(null),G(!1)},wt=async()=>{var t,r;if(A){re(!0),O(null),G(!1);try{const a=await D.delete(`seat/${A.seatId}/single`);a.data.isSuccess?(G(!0),setTimeout(()=>{Se(),g.invalidateQueries(["roomDetail",n]),g.invalidateQueries("rooms"),g.invalidateQueries("PhongChieuData")},1500)):(O(a.data.message||"Xóa ghế không thành công"),d.error(`Lỗi: ${a.data.message}`))}catch(a){const l=((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Đã xảy ra lỗi khi xóa ghế";O(l),d.error(`Lỗi: ${l}`)}finally{re(!1)}}},Tt=t=>{Fe(t),ae(!0)},Ce=()=>{ae(!1),Fe([]),ye(null),je(!1)},It=async()=>{var t,r;if(P.length!==0){_e(!0),ye(null),je(!1);try{const a=P.map(i=>i.seatId),l=!P[0].isActive;await Qt(a,l,!1),je(!0),setTimeout(()=>{Ce(),g.invalidateQueries(["roomDetail",n])},1500)}catch(a){const l=((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Đã xảy ra lỗi khi cập nhật trạng thái ghế";ye(l),d.error(`Lỗi: ${l}`)}finally{_e(!1)}}},kt=async t=>(await D.get(`room/${t}/info`)).data.data,Rt=async()=>(await D.get("seattype")).data.data||[],Dt=async()=>(await D.get("movietheater")).data.data||[],{data:s,isLoading:$t}=Ne(["roomDetail",n],()=>kt(n),{enabled:!!n}),{data:E,isLoading:At}=Ne("seatTypes",Rt,{onSuccess:t=>{t&&t.length>0&&U(t[0].seatTypeId)}}),{data:br}=Ne("movieTheaters",Dt,{onSuccess:t=>{Ct(t)}}),Pt=async({roomId:t,seatTypeId:r,index:a,mode:l})=>{var i;w(!0),T(!1),x(null);try{const F=(await D.get(`room/${t}/info`)).data.data.seats.filter(z=>l==="row"?z.atRow===String.fromCharCode(65+a):z.atColumn===a+1).map(z=>z.seatId),M=await D.put(`seat/type?seatTypeId=${r}`,F,{headers:{"Content-Type":"application/json",accept:"text/plain"}});return M.data.isSuccess&&T(!0),d.success(`${l==="row"?"Hàng":"Cột"} ghế đã được cập nhật thành công!`),g.invalidateQueries(["roomDetail",t]),M.data}catch(u){const b=((i=u.response)==null?void 0:i.reason)||"Đã xảy ra lỗi khi cập nhật ghế";throw x(b),d.error(`Lỗi: ${b}`),u}finally{w(!1)}},Wt=async(t,r)=>{var a,l;w(!0),T(!1),x(null);try{const i=await D.post(`seat/room/${t}/row?seatTypeId=${r}`,{headers:{accept:"text/plain"}});return i.data.isSuccess?(T(!0),d.success("Đã thêm hàng ghế mới thành công!"),g.invalidateQueries(["roomDetail",t]),g.invalidateQueries("rooms"),g.invalidateQueries("PhongChieuData")):(x(i.data.message||"Thêm hàng không thành công"),d.error(`Lỗi: ${i.data.message}`)),i.data}catch(i){const u=((l=(a=i.response)==null?void 0:a.data)==null?void 0:l.message)||"Đã xảy ra lỗi khi thêm hàng ghế";throw x(u),d.error(`Lỗi: ${u}`),i}finally{w(!1)}},Lt=async(t,r)=>{var a,l;w(!0),T(!1),x(null);try{const i=await D.post(`seat/room/${t}/column?seatTypeId=${r}`,{headers:{accept:"text/plain"}});return i.data.isSuccess?(T(!0),d.success("Đã thêm cột ghế mới thành công!"),g.invalidateQueries(["roomDetail",t]),g.invalidateQueries("rooms"),g.invalidateQueries("PhongChieuData")):(x(i.data.message||"Thêm cột không thành công"),d.error(`Lỗi: ${i.data.message}`)),i.data}catch(i){const u=((l=(a=i.response)==null?void 0:a.data)==null?void 0:l.message)||"Đã xảy ra lỗi khi thêm cột ghế";throw x(u),d.error(`Lỗi: ${u}`),i}finally{w(!1)}},Mt=(t,r)=>{Q(r),ee(null)},zt=t=>{U(t.target.value)},we=t=>{ee(t===C?null:t)},Ht=async()=>{if(!n||!p||C===null){d.error("Vui lòng chọn loại ghế và vị trí để cập nhật");return}try{await Pt({roomId:n,seatTypeId:p,index:C,mode:f})}catch(t){console.error("Error updating seats:",t)}},B=()=>{if(!E||!p)return"";const t=E.find(r=>r.seatTypeId===p);return t?t.typeName:""},Te=()=>{if(!E||!p)return 0;const t=E.find(r=>r.seatTypeId===p);return t?t.price:0},Vt=async()=>{if(!n||!p){d.error("Vui lòng chọn loại ghế để thêm hàng");return}try{await Wt(n,p)}catch(t){console.error("Error adding row:",t)}},Et=async()=>{if(!n||!p){d.error("Vui lòng chọn loại ghế để thêm cột");return}try{await Lt(n,p)}catch(t){console.error("Error adding column:",t)}},Nt=async(t,r)=>{if(!W){if(r.button===2){r.preventDefault(),rt(t);return}at(t.seatId)}},st=t=>{switch(t){case 0:return{bg:"#ffffff",border:"#e0e0e0",text:"#5f6368"};case 1:return{bg:"#f44336",border:"#d32f2f",text:"#ffffff"};case 2:return{bg:"#757575",border:"#616161",text:"#ffffff"};case 3:return{bg:"#ffc107",border:"#ffa000",text:"#212121"};default:return{bg:"#ffffff",border:"#e0e0e0",text:"#5f6368"}}},Qt=async(t,r,a=!0)=>{var l,i;w(!0),T(!1),x(null);try{const u=await D.put(`seat/room/status?isActived=${r}`,t,{headers:{"Content-Type":"application/json",accept:"text/plain"}});return u.data.isSuccess?(T(!0),a&&d.success(`Đã cập nhật trạng thái kích hoạt của ${t.length} ghế!`),g.invalidateQueries(["roomDetail",n]),$([])):(x(u.data.message||"Cập nhật không thành công"),d.error(`Lỗi: ${u.data.message}`)),u.data}catch(u){const b=((i=(l=u.response)==null?void 0:l.data)==null?void 0:i.message)||"Đã xảy ra lỗi khi cập nhật trạng thái ghế";throw x(b),d.error(`Lỗi: ${b}`),u}finally{w(!1)}},at=t=>{$(r=>r.includes(t)?r.filter(a=>a!==t):[...r,t])},Ut=t=>{ge(t.target.value==="true")},Kt=async()=>{if(I.length===0){d.error("Vui lòng chọn ít nhất một ghế để cập nhật");return}const t=s.seats.filter(r=>I.includes(r.seatId));Tt(t)},Ot=async(t,r,a,l)=>{var i,u;w(!0),T(!1),x(null);try{const b=await D.post("seat/create",{roomId:t,seatTypeId:r,atRow:a,atColumn:l},{headers:{"Content-Type":"application/json",accept:"text/plain"}});return b.data.isSuccess?(T(!0),d.success(`Đã tạo ghế ${a}${l} thành công!`),g.invalidateQueries(["roomDetail",t]),!0):(x(b.data.message||"Tạo ghế không thành công"),d.error(`Lỗi: ${b.data.message}`),!1)}catch(b){const m=((u=(i=b.response)==null?void 0:i.data)==null?void 0:u.message)||"Đã xảy ra lỗi khi tạo ghế";throw x(m),d.error(`Lỗi: ${m}`),b}finally{w(!1)}},Bt=async(t,r)=>{if(!n||!p||W){d.error("Vui lòng chọn loại ghế để tạo ghế mới");return}try{await Ot(n,p,t,r)}catch(a){console.error("Error creating seat:",a)}},Ft=()=>{Ge(s.roomName||""),Ye(s.row||0),Je(s.column||0),tt(s.movieTheaterId||""),qe(!0),ce(null),ve(!1)},Ie=()=>{qe(!1)},_t=async()=>{var t,r;if(!n||!Y.trim()){d.error("Tên phòng không được để trống");return}if(oe<=0||ie<=0){d.error("Số hàng và cột phải lớn hơn 0");return}if(!he){d.error("Vui lòng chọn rạp chiếu phim");return}Ze(!0),ce(null),ve(!1);try{const a={roomId:n,roomName:Y,row:N?s.row:oe,column:N?s.column:ie,total:s.total,movieTheaterId:he};console.log("Updating room with payload:",a);const l=await D.put(`room/${n}`,a);if(l.data.isSuccess){if(ve(!0),d.success("Cập nhật thông tin phòng thành công!"),s){const i={...s,roomName:Y,row:N?s.row:oe,column:N?s.column:ie,movieTheaterId:he};g.setQueryData(["roomDetail",n],i)}g.invalidateQueries(["roomDetail",n]),g.invalidateQueries("rooms"),g.invalidateQueries("PhongChieuData"),setTimeout(()=>{Ie()},1500)}else ce(l.data.message||"Cập nhật không thành công"),d.error(`Lỗi: ${l.data.message}`)}catch(a){const l=((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Đã xảy ra lỗi khi cập nhật thông tin phòng";ce(l),d.error(`Lỗi: ${l}`)}finally{Ze(!1)}};if(h.useEffect(()=>{s&&(console.log("Room data in component:",s),console.log("Room seats:",s.seats))},[s]),!n)return e.jsx(Qe,{children:e.jsx(J,{sx:{p:4,textAlign:"center"},children:e.jsx(c,{variant:"h6",color:"error",children:"Không tìm thấy mã phòng chiếu"})})});if($t||At)return e.jsx(rr,{});if(!s)return e.jsx(Qe,{children:e.jsx(J,{sx:{p:4,textAlign:"center"},children:e.jsx(c,{variant:"h6",color:"error",children:"Không tìm thấy thông tin phòng chiếu"})})});const N=s.seats&&s.seats.length>0;return e.jsxs(Qe,{children:[e.jsxs(o,{sx:{mb:4},children:[e.jsx(y,{variant:"outlined",startIcon:e.jsx(gt,{}),onClick:()=>S("/admin/ql-phong-chieu",{state:{refresh:!0}}),sx:{mb:2},children:"Quay lại danh sách phòng"}),e.jsxs(Re,{elevation:0,sx:{p:3,borderRadius:2,bgcolor:"primary.main",color:"white",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",flexGrow:1},children:[e.jsx(nr,{sx:{mr:2,fontSize:32}}),e.jsxs(o,{children:[e.jsx(c,{variant:"h5",component:"h1",fontWeight:"bold",children:s.roomName}),e.jsx(c,{variant:"body2",sx:{opacity:.8},children:`${s.row} hàng × ${s.column} cột (${s.total} ghế)`})]})]}),e.jsx(y,{variant:"contained",color:"secondary",onClick:Ft,startIcon:e.jsx(xt,{}),sx:{boxShadow:2,"&:hover":{boxShadow:4}},children:"Sửa tên phòng"})]})]}),e.jsxs(j,{container:!0,spacing:3,children:[e.jsx(j,{item:!0,xs:12,md:4,children:e.jsxs(sr,{spacing:3,children:[e.jsxs(J,{sx:{borderRadius:2,overflow:"hidden",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[e.jsx(Ue,{title:"Thông tin phòng",titleTypographyProps:{fontWeight:"bold"},avatar:e.jsx(De,{sx:{bgcolor:"secondary.main"},children:e.jsx(bt,{})}),sx:{bgcolor:"secondary.light",color:"secondary.contrastText"}}),e.jsx($e,{}),e.jsx(o,{sx:{p:3},children:e.jsxs(j,{container:!0,spacing:2,children:[e.jsx(j,{item:!0,xs:6,children:e.jsxs(o,{sx:{bgcolor:v("#f5f5f5",.5),p:2,borderRadius:2,height:"100%"},children:[e.jsx(c,{variant:"body2",sx:{color:"text.secondary",mb:1},children:"Số hàng ghế"}),e.jsx(c,{variant:"h4",fontWeight:"medium",color:"primary",children:s.row})]})}),e.jsx(j,{item:!0,xs:6,children:e.jsxs(o,{sx:{bgcolor:v("#f5f5f5",.5),p:2,borderRadius:2,height:"100%"},children:[e.jsx(c,{variant:"body2",sx:{color:"text.secondary",mb:1},children:"Số cột"}),e.jsx(c,{variant:"h4",fontWeight:"medium",color:"primary",children:s.column})]})}),e.jsx(j,{item:!0,xs:12,children:e.jsxs(o,{sx:{bgcolor:v("#f5f5f5",.5),p:2,borderRadius:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(o,{children:[e.jsx(c,{variant:"body2",sx:{color:"text.secondary",mb:1},children:"Tổng số ghế"}),e.jsx(c,{variant:"h4",fontWeight:"medium",color:"primary",children:s.total})]}),e.jsx(q,{sx:{fontSize:48,color:R.palette.primary.light,opacity:.7}})]})}),e.jsx(j,{item:!0,xs:12,children:e.jsx(y,{variant:"contained",color:"primary",fullWidth:!0,startIcon:e.jsx(k,{}),onClick:()=>S("/admin/ql-thoi-gian-chieu/them-thoi-gian-chieu",{state:{roomId:n}}),sx:{mt:2},children:"Tạo lịch chiếu cho phòng này"})})]})})]}),e.jsxs(J,{sx:{borderRadius:2,overflow:"hidden",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[e.jsx(Ue,{title:"Cập nhật loại ghế",titleTypographyProps:{fontWeight:"bold"},avatar:e.jsx(De,{sx:{bgcolor:"primary.main"},children:e.jsx(k,{})}),sx:{bgcolor:"primary.light",color:"primary.contrastText"}}),e.jsx($e,{}),e.jsx(o,{sx:{p:3},children:N?e.jsxs(e.Fragment,{children:[e.jsxs(ir,{value:f,onChange:Mt,variant:"fullWidth",indicatorColor:"primary",textColor:"primary",sx:{mb:3,"& .MuiTab-root":{borderRadius:1,mr:1,fontWeight:"medium","&.Mui-selected":{backgroundColor:v("#bbdefb",.5)}}},children:[e.jsx(ft,{value:"row",label:"Chọn hàng",icon:e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(q,{sx:{mr:.5,fontSize:18}}),e.jsx(q,{sx:{mr:.5,fontSize:18}}),e.jsx(q,{sx:{fontSize:18}})]}),iconPosition:"start"}),e.jsx(ft,{value:"column",label:"Chọn cột",icon:e.jsxs(o,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(q,{sx:{fontSize:16}}),e.jsx(q,{sx:{fontSize:16}})]}),iconPosition:"start"})]}),e.jsxs(o,{sx:t=>({mb:3,p:2,borderRadius:2,bgcolor:B()?v(t.palette.primary.light,.2):v("#f5f5f5",.2),border:"1px solid",borderColor:B()?v(t.palette.primary.main,.5):v("#e0e0e0",.5)}),children:[e.jsxs(Ae,{fullWidth:!0,children:[e.jsx(Pe,{children:"Loại ghế"}),e.jsx(We,{value:p,onChange:zt,label:"Loại ghế",sx:{"& .MuiSelect-select":{display:"flex",alignItems:"center",gap:1}},children:E==null?void 0:E.map(t=>e.jsxs(de,{value:t.seatTypeId,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(k,{color:p===t.seatTypeId?"primary":"action",fontSize:"small"}),e.jsx("span",{children:t.typeName}),e.jsx(Le,{size:"small",label:`${t.price.toLocaleString("vi-VN")}đ`,color:"primary",variant:"outlined",sx:{ml:"auto"}})]},t.seatTypeId))})]}),B()&&e.jsxs(o,{sx:{mt:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(c,{variant:"body2",children:["Đã chọn: ",e.jsx("strong",{children:B()})]}),e.jsx(Le,{label:`${Te().toLocaleString("vi-VN")}đ`,color:"secondary",size:"small"})]})]}),e.jsx(c,{variant:"body1",fontWeight:"medium",sx:{mb:1.5},children:f==="row"?"Chọn hàng để cập nhật:":"Chọn cột để cập nhật:"}),e.jsx(o,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:3,p:2,borderRadius:1,bgcolor:"#f5f5f5"},children:Array.from({length:f==="row"?s.row:s.column}).map((t,r)=>e.jsx(Le,{label:f==="row"?String.fromCharCode(65+r):r+1,onClick:()=>we(r),color:C===r?"primary":"default",variant:C===r?"filled":"outlined",sx:{cursor:"pointer",fontWeight:"medium",minWidth:38,transition:"all 0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 3px 5px rgba(0,0,0,0.1)"}}},r))}),e.jsxs(j,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(j,{item:!0,xs:12,sm:6,children:e.jsx(Z,{title:`Thêm hàng mới với ghế loại: ${B()} (${Te().toLocaleString("vi-VN")}đ)`,children:e.jsx("span",{children:e.jsx(y,{variant:"outlined",color:"primary",fullWidth:!0,onClick:Vt,disabled:!p||W,sx:{py:1.2,borderRadius:2,fontWeight:"medium"},startIcon:e.jsx(k,{}),children:"Thêm hàng mới"})})})}),e.jsx(j,{item:!0,xs:12,sm:6,children:e.jsx(Z,{title:`Thêm cột mới với ghế loại: ${B()} (${Te().toLocaleString("vi-VN")}đ)`,children:e.jsx("span",{children:e.jsx(y,{variant:"outlined",color:"primary",fullWidth:!0,onClick:Et,disabled:!p||W,sx:{py:1.2,borderRadius:2,fontWeight:"medium"},startIcon:e.jsx(k,{}),children:"Thêm cột mới"})})})})]}),e.jsx(y,{variant:"contained",fullWidth:!0,onClick:Ht,sx:{py:1.2,borderRadius:2,fontWeight:"bold",boxShadow:2,backgroundColor:p?"#4caf50":"#2196f3",color:"white",textShadow:"0 1px 1px rgba(0,0,0,0.2)",letterSpacing:"0.5px",transition:"background-color 0.3s ease","&:hover":{backgroundColor:p?"#388e3c":"#1976d2"}},startIcon:W?void 0:e.jsx(mt,{}),children:W?e.jsx(ue,{size:24,color:"inherit"}):`Cập nhật ${f==="row"?"hàng":"cột"} đã chọn`})]}):e.jsxs(o,{sx:{display:"flex",flexDirection:"column",alignItems:"center",py:4},children:[e.jsx(k,{sx:{color:"grey.400",fontSize:60,mb:2}}),e.jsx(c,{variant:"h6",color:"text.secondary",sx:{mb:2,textAlign:"center"},children:"Phòng hiện không có ghế nào"}),e.jsx(o,{sx:{display:"flex",flexDirection:"column",gap:2,width:"100%",maxWidth:300},children:e.jsx(y,{variant:"contained",color:"primary",onClick:()=>S("/admin/ql-phong-chieu"),startIcon:e.jsx(ar,{}),children:"Trở về trang danh sách phòng để tạo ghế"})})]})})]})]})}),e.jsx(j,{item:!0,xs:12,md:8,children:e.jsxs(J,{sx:{p:0,overflow:"hidden",borderRadius:2,boxShadow:"0 4px 12px rgba(0,0,0,0.1)",height:"100%"},children:[e.jsx(Ue,{title:"Sơ đồ phòng chiếu",titleTypographyProps:{fontWeight:"bold"},avatar:e.jsx(De,{sx:{bgcolor:"#1e88e5"},children:e.jsx(bt,{})}),sx:{bgcolor:"#bbdefb"}}),e.jsx($e,{}),e.jsxs(o,{sx:{p:3},children:[e.jsxs(o,{sx:{width:"80%",height:"40px",background:"linear-gradient(to bottom, #3f51b5, #c5cae9)",margin:"0 auto 50px",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"4px",position:"relative",overflow:"hidden","&:before":{content:'""',position:"absolute",top:0,left:"-150%",width:"150%",height:"100%",background:"rgba(255, 255, 255, 0.3)",transform:"skewX(-45deg)",animation:"moveLight 3s ease-in-out infinite"},"@keyframes moveLight":{"0%":{left:"-150%"},"50%":{left:"150%"},"100%":{left:"-150%"}},boxShadow:"0 4px 12px rgba(0,0,0,0.3), 0 0 20px rgba(116, 132, 214, 0.8)"},children:[e.jsx(pr,{sx:{color:"white",mr:1}}),e.jsx(c,{variant:"subtitle1",sx:{color:"white",fontWeight:"medium"},children:"Màn hình"})]}),N?e.jsxs(e.Fragment,{children:[e.jsxs(Re,{elevation:0,sx:{p:4,borderRadius:2,bgcolor:"#f8f9fa",mb:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(o,{sx:{display:"flex",mb:2,justifyContent:"center",width:"fit-content"},children:Array.from({length:s.column}).map((t,r)=>e.jsx(Z,{title:`Chọn cột ${r+1}`,children:e.jsx(o,{sx:{width:40,height:30,display:"flex",justifyContent:"center",alignItems:"center",mx:"4px",cursor:"pointer",bgcolor:f==="column"&&C===r?R.palette.primary.main:"#eeeeee",color:f==="column"&&C===r?"white":"text.primary",borderRadius:2,fontSize:"0.9rem",transition:"all 0.2s",fontWeight:"bold","&:hover":{bgcolor:f==="column"?v(R.palette.primary.main,.7):"#e0e0e0"}},onClick:()=>{f==="column"&&we(r)},children:r+1})},r))}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:[e.jsx(o,{sx:{display:"flex",flexDirection:"column",gap:"8px",mr:2},children:Array.from({length:s.row}).map((t,r)=>e.jsx(Z,{title:`Chọn hàng ${String.fromCharCode(65+r)}`,children:e.jsx(o,{sx:{width:30,height:40,display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",bgcolor:f==="row"&&C===r?R.palette.primary.main:"#eeeeee",color:f==="row"&&C===r?"white":"text.primary",borderRadius:2,fontSize:"0.9rem",fontWeight:"bold",transition:"all 0.2s","&:hover":{bgcolor:f==="row"?v(R.palette.primary.main,.7):"#e0e0e0"}},onClick:()=>{f==="row"&&we(r)},children:String.fromCharCode(65+r)})},r))}),e.jsx(o,{sx:{display:"grid",gridTemplateColumns:`repeat(${s.column}, 40px)`,gridTemplateRows:`repeat(${s.row}, 40px)`,gap:"8px",justifyContent:"center"},children:Array.from({length:s.row*s.column}).map((t,r)=>{var ht,dt;const a=Math.floor(r/s.column),l=r%s.column,i=String.fromCharCode(65+a),u=l+1,b=`${i}${u}`,m=(ht=s.seats)==null?void 0:ht.find(H=>H.atRow===i&&H.atColumn===u);r===0&&console.log("First seat search:",{rowLetter:i,colNumber:u,foundSeat:!!m,allSeats:(dt=s.seats)==null?void 0:dt.slice(0,3)});const F=f==="row"&&C===a||f==="column"&&C===l,M=m&&I.includes(m.seatId),z=st(m?m.status:0),ke=m&&!m.isActive;return e.jsx(Z,{title:m?`${b} - ${m.status===0?"Có sẵn":m.status===1?"Không khả dụng":m.status===2?"Đã bán":m.status===3?"Đã đặt":"Không xác định"}${ke?" - Đã vô hiệu hóa":" - Đã kích hoạt"}${M?" - Đã chọn":""}`:`${b} - Vị trí trống`,children:m?e.jsx(o,{onClick:H=>H.ctrlKey||H.metaKey?at(m.seatId):Nt(m,H),onContextMenu:H=>{H.preventDefault(),rt(m)},sx:{width:"40px",height:"40px",backgroundColor:M?"#9c27b0":F?R.palette.primary.main:z.bg,border:"1px solid",borderColor:M?"#7b1fa2":F?R.palette.primary.dark:z.border,borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"0.9rem",color:M||F?"white":z.text,transition:"all 0.15s ease",boxShadow:F?"none":M?"0 0 0 2px #9c27b0":"inset 0 -2px 0 0 rgba(0,0,0,0.1)",cursor:"pointer",opacity:ke?.3:1,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",filter:"brightness(0.95)"},position:"relative","&:before":ke?{content:'""',position:"absolute",width:"100%",height:"2px",backgroundColor:"#f44336",top:"50%",transform:"translateY(-50%) rotate(45deg)"}:{}},children:b}):e.jsx(o,{onClick:()=>Bt(i,u),sx:{width:"40px",height:"40px",borderRadius:"4px",border:"1px dashed #ccc",display:"flex",justifyContent:"center",alignItems:"center",color:"#aaa",fontSize:"0.8rem",cursor:"pointer","&:hover":{border:"1px dashed #2196f3",backgroundColor:v("#bbdefb",.3),transform:"translateY(-2px)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",color:"primary.main"}},children:b})},`seat-${r}`)})})]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mt:2,p:2,borderRadius:2,bgcolor:v("#e3f2fd",.6)},children:[e.jsx(k,{sx:{color:"primary.main",mr:1,fontSize:20}}),e.jsx(c,{variant:"body2",color:"primary.dark",fontWeight:"medium",children:"Nhấp vào vị trí trống để tạo ghế mới với loại ghế đã chọn"})]}),I.length>0&&e.jsxs(Re,{elevation:3,sx:{position:"sticky",bottom:20,left:0,right:0,zIndex:10,p:2,mt:3,borderRadius:2,bgcolor:v(R.palette.background.paper,.9),backdropFilter:"blur(8px)",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(k,{sx:{color:"#9c27b0",mr:1}}),e.jsxs(c,{variant:"body1",fontWeight:"medium",children:["Đã chọn ",I.length," ghế"]})]}),e.jsxs(o,{sx:{display:"flex",gap:2},children:[e.jsx(y,{variant:"outlined",color:"secondary",onClick:()=>$([]),children:"Hủy chọn"}),e.jsxs(Ae,{variant:"outlined",size:"small",sx:{minWidth:120,mx:2},children:[e.jsx(Pe,{id:"active-status-select-label",children:"Trạng thái"}),e.jsxs(We,{labelId:"active-status-select-label",id:"active-status-select",value:V?"true":"false",onChange:Ut,label:"Trạng thái",children:[e.jsx(de,{value:"true",children:"Kích hoạt"}),e.jsx(de,{value:"false",children:"Vô hiệu hóa"})]})]}),e.jsx(y,{variant:"contained",color:"warning",onClick:Kt,startIcon:e.jsx(k,{}),children:"Cập nhật ghế"})]})]})]}):e.jsxs(o,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:400},children:[e.jsx(k,{sx:{color:"grey.300",fontSize:100,mb:3}}),e.jsx(c,{variant:"h5",color:"text.secondary",sx:{mb:2,textAlign:"center"},children:"Phòng chưa có ghế nào"}),e.jsx(c,{variant:"body1",color:"text.secondary",sx:{mb:3,textAlign:"center",maxWidth:500},children:'Vui lòng trở về trang danh sách phòng và nhấn vào nút "Tạo ghế" để tạo ghế cho phòng chiếu này.'}),e.jsx(y,{variant:"contained",color:"primary",onClick:()=>S("/admin/ql-phong-chieu"),startIcon:e.jsx(gt,{}),children:"Quay lại danh sách phòng"})]})]})]})})]}),e.jsxs(Me,{open:me,onClose:Se,fullWidth:!0,maxWidth:"xs",children:[e.jsxs(ze,{sx:{bgcolor:"error.main",color:"white",pb:2},children:[e.jsx(pt,{sx:{mr:1,verticalAlign:"middle"}}),"Xóa ghế"]}),e.jsxs(He,{sx:{pt:3,pb:2},children:[e.jsxs(c,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:["Bạn có chắc chắn muốn xóa ghế ",A==null?void 0:A.atRow,A==null?void 0:A.atColumn,"? Hành động này không thể hoàn tác."]}),e.jsx(o,{sx:{p:2,bgcolor:"#fff8e1",borderRadius:1,border:"1px solid #ffe57f",mb:2},children:e.jsxs(c,{variant:"body2",color:"warning.dark",children:[e.jsx("strong",{children:"Lưu ý:"})," Việc xóa ghế sẽ ảnh hưởng đến các lịch chiếu nếu có. Hãy chắc chắn rằng ghế này không còn được sử dụng cho bất kỳ lịch chiếu nào."]})}),fe&&e.jsx(X,{severity:"success",sx:{mb:2},children:"Xóa ghế thành công!"}),se&&e.jsx(X,{severity:"error",sx:{mb:2},children:se})]}),e.jsxs(Ve,{sx:{px:3,pb:3},children:[e.jsx(y,{onClick:Se,disabled:K,variant:"outlined",children:"Hủy"}),e.jsx(y,{onClick:wt,variant:"contained",color:"error",disabled:K,startIcon:K?e.jsx(ue,{size:20,color:"inherit"}):e.jsx(pt,{}),children:K?"Đang xóa...":"Xác nhận xóa"})]})]}),e.jsxs(Me,{open:be,onClose:Ce,fullWidth:!0,maxWidth:"xs",children:[e.jsxs(ze,{sx:{bgcolor:"warning.main",color:"white",pb:2},children:[e.jsx(k,{sx:{mr:1,verticalAlign:"middle"}}),(nt=P[0])!=null&&nt.isActive?"Vô hiệu hóa":"Kích hoạt"," ghế"]}),e.jsxs(He,{sx:{pt:3,pb:2},children:[e.jsxs(c,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:["Bạn có chắc chắn muốn ",(ot=P[0])!=null&&ot.isActive?"vô hiệu hóa":"kích hoạt"," ",P.length," ghế đã chọn?"]}),e.jsx(o,{sx:{p:2,bgcolor:"#fff8e1",borderRadius:1,border:"1px solid #ffe57f",mb:2},children:e.jsxs(c,{variant:"body2",color:"warning.dark",children:[e.jsx("strong",{children:"Lưu ý:"})," ",(it=P[0])!=null&&it.isActive?"Việc vô hiệu hóa ghế sẽ không cho phép đặt vé cho các ghế này trong các lịch chiếu.":"Việc kích hoạt ghế sẽ cho phép đặt vé cho các ghế này trong các lịch chiếu."]})}),yt&&e.jsxs(X,{severity:"success",sx:{mb:2},children:[(lt=P[0])!=null&&lt.isActive?"Đã vô hiệu hóa":"Đã kích hoạt"," ",P.length," ghế thành công!"]}),Xe&&e.jsx(X,{severity:"error",sx:{mb:2},children:Xe})]}),e.jsxs(Ve,{sx:{px:3,pb:3},children:[e.jsx(y,{onClick:Ce,disabled:ne,variant:"outlined",children:"Hủy"}),e.jsx(y,{onClick:It,variant:"contained",color:"warning",disabled:ne,startIcon:ne?e.jsx(ue,{size:20,color:"inherit"}):e.jsx(k,{}),children:ne?"Đang xử lý...":(ct=P[0])!=null&&ct.isActive?"Vô hiệu hóa":"Kích hoạt"})]})]}),e.jsxs(Me,{open:jt,onClose:Ie,fullWidth:!0,maxWidth:"xs",children:[e.jsxs(ze,{sx:{bgcolor:"primary.main",color:"white",pb:2},children:[e.jsx(xt,{sx:{mr:1,verticalAlign:"middle"}}),"Chỉnh sửa thông tin phòng"]}),e.jsxs(He,{sx:{pt:3,pb:2},children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,children:"Cập nhật tên phòng chiếu"}),e.jsx(Ee,{autoFocus:!0,margin:"dense",id:"roomName",label:"Tên phòng",type:"text",fullWidth:!0,variant:"outlined",value:Y,onChange:t=>Ge(t.target.value),sx:{mb:2}}),e.jsxs(Ae,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(Pe,{id:"movie-theater-label",children:"Rạp chiếu phim"}),e.jsx(We,{labelId:"movie-theater-label",id:"movie-theater-select",value:he,onChange:t=>tt(t.target.value),label:"Rạp chiếu phim",children:St.map(t=>e.jsx(de,{value:t.movieTheaterId,children:t.name},t.movieTheaterId))})]}),N?e.jsxs(o,{sx:{mt:2,mb:2,p:2,bgcolor:v("#f5f5f5",.7),borderRadius:1,border:"1px solid",borderColor:"divider"},children:[e.jsxs(c,{variant:"subtitle2",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[e.jsx(or,{sx:{fontSize:18,mr:.5,color:"info.main"}}),"Kích thước phòng hiện tại: ",s.row," hàng × ",s.column," cột"]}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:1},children:"Không thể thay đổi kích thước vì phòng đã có ghế. Xóa tất cả ghế trước khi thay đổi."})]}):e.jsxs(o,{sx:{mt:2,mb:2},children:[e.jsx(c,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:"Cấu hình kích thước phòng"}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:2},children:"Bạn có thể thay đổi số hàng và cột vì phòng chưa có ghế"}),e.jsxs(j,{container:!0,spacing:2,children:[e.jsx(j,{item:!0,xs:6,children:e.jsx(Ee,{id:"roomRow",label:"Số hàng",type:"number",fullWidth:!0,variant:"outlined",value:oe,onChange:t=>Ye(parseInt(t.target.value)),inputProps:{min:1}})}),e.jsx(j,{item:!0,xs:6,children:e.jsx(Ee,{id:"roomColumn",label:"Số cột",type:"number",fullWidth:!0,variant:"outlined",value:ie,onChange:t=>Je(parseInt(t.target.value)),inputProps:{min:1}})})]})]}),vt&&e.jsx(X,{severity:"success",sx:{mb:2},children:"Cập nhật thông tin phòng thành công!"}),et&&e.jsx(X,{severity:"error",sx:{mb:2},children:et})]}),e.jsxs(Ve,{sx:{px:3,pb:3},children:[e.jsx(y,{onClick:Ie,disabled:le,variant:"outlined",children:"Hủy"}),e.jsx(y,{onClick:_t,variant:"contained",color:"primary",disabled:le||!Y.trim(),startIcon:le?e.jsx(ue,{size:20,color:"inherit"}):e.jsx(mt,{}),children:le?"Đang cập nhật...":"Cập nhật"})]})]})]})},Dr=Object.freeze(Object.defineProperty({__proto__:null,default:gr},Symbol.toStringTag,{value:"Module"}));export{q as C,gr as a,Dr as b};
